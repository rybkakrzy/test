private List<ZswBalanceDocument> ReadBalanceDocument(byte[] excelContent, string documentId)
{
    var documents = new List<ZswBalanceDocument>();

    using var stream = new MemoryStream(excelContent);
    using var document = SpreadsheetDocument.Open(stream, isEditable: false);

    var workbookPart = document.WorkbookPart;
    var sheet = workbookPart.Workbook.Sheets.Elements<Sheet>().First();
    var worksheetPart = (WorksheetPart)workbookPart.GetPartById(sheet.Id);

    var sharedStringTable = workbookPart.SharedStringTablePart.SharedStringTable;

    string GetCellValue(string cellReference, Row row)
    {
        var cell = row.Elements<Cell>()
            .FirstOrDefault(c => c.CellReference?.Value.StartsWith(cellReference) == true);

        if (cell == null || cell.CellValue == null)
            return string.Empty;

        var value = cell.CellValue.InnerText;

        if (cell.DataType != null && cell.DataType.Value == CellValues.SharedString)
        {
            var index = int.Parse(value);
            return sharedStringTable.ElementAt(index).InnerText;
        }

        return value;
    }

    // Iterujemy po wszystkich wierszach
    foreach (var row in worksheetPart.Worksheet.Descendants<Row>())
    {
        // tu możesz sprawdzić np. numer wiersza i pominąć nagłówki
        if (row.RowIndex.Value < 3) // pomijamy nagłówki
            continue;

        var balanceDoc = new ZswBalanceDocument
        {
            DocumentId = documentId,
            ShortAccountNumber = GetCellValue("A", row),
            BalanceAtDate = ParseDate(GetCellValue("B", row)),
            TotalCapital = Math.Round(ParseDecimal(GetCellValue("C", row)), 2),
            DueCapital = Math.Round(ParseDecimal(GetCellValue("D", row)), 2),
            ContractualInterest = Math.Round(ParseDecimal(GetCellValue("E", row)), 2),
            DueInterest = Math.Round(ParseDecimal(GetCellValue("F", row)), 2),
            DefaultInterest = Math.Round(ParseDecimal(GetCellValue("G", row)), 2),
            FeesOrCommissions = Math.Round(ParseDecimal(GetCellValue("H", row)), 2),
            TotalRepaymentAmount = Math.Round(ParseDecimal(GetCellValue("I", row)), 2),
            Currency = GetCellValue("J", row),
            DueDate = ParseDate(GetCellValue("K", row))
        };

        documents.Add(balanceDoc);
    }

    return documents;
}
