import { Component } from '@angular/core';
import { FormBuilder, FormGroup, Validators } from '@angular/forms';

@Component({
  selector: 'app-dynamic-control',
  templateUrl: './dynamic-control.component.html',
})
export class DynamicControlComponent {
  form: FormGroup;

  constructor(private fb: FormBuilder) {
    this.form = this.fb.group({
      name: ['', Validators.required],
      provideDetails: [false]
    });

    // Obsługa dynamicznego pola na podstawie wartości checkboxa
    this.form.get('provideDetails')?.valueChanges.subscribe(checked => {
      if (checked) {
        // Dodajemy pole "details" do FormGroup
        this.form.addControl('details', this.fb.control('', Validators.required));
      } else {
        // Usuwamy pole "details"
        this.form.removeControl('details');
      }
    });
  }

  onSubmit(): void {
    if (this.form.valid) {
      console.log('Dane formularza:', this.form.value);
    } else {
      this.form.markAllAsTouched();
    }
  }
}



<form [formGroup]="form" (ngSubmit)="onSubmit()">
  <label>
    Imię:
    <input type="text" formControlName="name">
  </label>

  <label>
    <input type="checkbox" formControlName="provideDetails">
    Chcę podać więcej danych
  </label>

  <!-- Wyświetl dodatkowe pole, jeśli zostało dodane do FormGroup -->
  <div *ngIf="form.contains('details')">
    <label>
      Szczegóły:
      <input type="text" formControlName="details">
    </label>
  </div>

  <button type="submit">Wyślij</button>
</form>
