public static DateTime ParseDate(string? input)
{
    string normalized = Normalize(input);

    // Spróbuj sparsować jako data tekstowa, np. "2025-05-23"
    if (DateTime.TryParseExact(
            normalized,
            new[] { "yyyy-MM-dd", "dd.MM.yyyy", "yyyy/MM/dd" }, // dopasuj do formatu
            CultureInfo.InvariantCulture,
            DateTimeStyles.None,
            out var date))
    {
        return date;
    }

    // Jeśli nie udało się, spróbuj jako Excel OADate
    if (double.TryParse(normalized, NumberStyles.Any, CultureInfo.InvariantCulture, out var oaDate))
    {
        try
        {
            return DateTime.FromOADate(oaDate);
        }
        catch
        {
            // out of range
        }
    }

    // Nie udało się sparsować
    return DateTime.MinValue;
}
